pkgname=mos-latest
pkgver=autogenerated_below
pkgrel=1
pkgdesc="Mongoose-OS build tool (latest)"
arch=('i686' 'x86_64')
license=('Apache')
url="https://mongoose-os.com/docs/mongoose-os/quickstart/setup.md"
depends=('libftdi-compat' 'libusb')
makedepends=(
    'gcc'
    'go'
    'git'
    'jshon'
    'make'
    'pkgconf'
    'python3'
)
conflicts=('mos')

source=(git+https://github.com/mongoose-os/mos.git#branch=master)

md5sums=('SKIP')

pkgver() {
  make -C "$srcdir/mos" clean-version version/version.json > /dev/null 2>&1
  jshon -F "$srcdir/mos/version/version.json" -e build_version -u
}

build() {
  make -C "$srcdir/mos" mos
}

package() {
  install -D "$srcdir/mos/mos" "$pkgdir/usr/bin/mos"
}
